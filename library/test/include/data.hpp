#include <mbsm.hpp>

mbsm::candidates::Signature expected_query_signatures[]{// Graph 1
                                                        {0b00000000000000000000001100000000},
                                                        {0b00000000000000000000000100000000},
                                                        {0b00000000000000000000000100000000},
                                                        {0b00000000000000000000001000000000},
                                                        {0b00000000000000000000000100000100},
                                                        {0b00000000000000000000000100000000},
                                                        // Graph 2
                                                        {0b00000000000000000010000000001000},
                                                        {0b00000000000000010000000000000000},
                                                        {0b00000000000000010000000000000000},
                                                        {0b00000000000000010000000000000000},
                                                        {0b00000000000000010000000000000000},
                                                        // Graph 3
                                                        {0b00000000000000000000000000000100},
                                                        {0b00000000000000000000010000000100},
                                                        {0b00000000000000000000000000001000},
                                                        {0b00000000000000000000000000001000},
                                                        {0b00000000000000000000000000001000},
                                                        {0b00000000000000000000000000001000},
                                                        {0b00000000000000000000000000001000},
                                                        {0b00000000000000000000000000001000},
                                                        {0b00000000000000000001000000000100},
                                                        {0b00000000000000000000000000000100}};

mbsm::candidates::Signature expected_data_signatures[]{// Graph 1
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000100000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000001000000001000000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001000000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       // Graph 2
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000001010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000001010100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000100100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001000000000},
                                                       // Graph 3
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000010000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000010000000100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001001000000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000011000000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000010000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001000100000000},
                                                       {0b00000000000000010000000100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000010000000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000010000000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001000000000},
                                                       // Graph 4
                                                       {0b00000000000000000010010100000000},
                                                       {0b00000000000000010000000000000000},
                                                       {0b00000000000000010000000000000000},
                                                       {0b00000000000000010000000000000000},
                                                       {0b00000000000000100000010000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000010000100000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000000001010100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000010000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000010000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000001100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000010000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000001010100000000},
                                                       {0b00000000000000000000000100000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000010000100000000000},
                                                       {0b00000000000000000000001000000000},
                                                       {0b00000000000000100000010000000000},
                                                       {0b00000000000000000010010100000000},
                                                       {0b00000000000000010000000000000000},
                                                       {0b00000000000000010000000000000000},
                                                       {0b00000000000000010000000000000000},
                                                       {0b00000000000000000000010100000000},
                                                       {0b00000000000000000000010100000000},
                                                       // Graph 5
                                                       {0b00000000000000000000000000001000},
                                                       {0b00000000000000000000000000000100},
                                                       {0b00000000000000000000000000001000},
                                                       {0b00000000000000000000000000000100}};

std::vector<mbsm::candidates::Signature> getExpectedDataSignatures(std::string fname) {
  auto data = mbsm::io::loadDataGraphsFromFile(fname);

  size_t num_nodes = 0;
  for (auto& graph : data) { num_nodes += graph.getNumNodes(); }

  std::vector<mbsm::candidates::Signature> signatures(num_nodes);

  size_t offset = 0;

  for (auto& graph : data) {
    for (int i = 0; i < graph.getNumNodes(); ++i) {
      auto start_node = graph.getRowOffsets()[i];
      auto end_node = graph.getRowOffsets()[i + 1];

      for (int j = start_node; j < end_node; ++j) {
        auto neighbor = graph.getColumnIndices()[j];
        signatures[offset + i].incrementLabelCount(graph.getLabels()[neighbor]);
      }
    }
    offset += graph.getNumNodes();
  }

  return signatures;
}